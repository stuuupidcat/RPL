pattern CVE-2018-20992-MIR

patt {
    use std::vec::Vec;

    p_vec_set_len_to_extend[
        $T: ty,               // type of the vector elements
        $vec: place(Vec<$T>), // vector to set the length of
    ] = #[mir] pub fn _ (..) -> _ {
        let $new_len: usize = _;                      // new length to set
        let $vec_ref: &Vec<$T> = &$vec;               // reference to the vector
        let $old_len: usize = copy ((*$vec_ref).len); // old length of the vector
        // SwitchInt Here or If here?
        #without!(if $old_len >= $new_len) {
            let $vec_mut_ref: &mut Vec<$T> = &mut $vec;
            (*$vec_mut_ref).len = copy $new_len;
        }
    }
}